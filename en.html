<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8" />
	<link rel="stylesheet" type="text/css" href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
	<script>
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
	if (navigator.userAgent.toLowerCase().match("mobile") != null)
		alert("!!Don't use mobile devices to browse this page!!\nIf use mobile device cause something wrong, I won't take any responsibility")
	ga('create', 'UA-43236443-3', 'auto');
	ga('send', 'pageview');
	</script>
	<script src="//code.jquery.com/jquery.min.js"></script>
	<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
	<script src="./c.js"></script>
	<script>
	function draw(d){"u"==d?$("#load").modal("show"):"s"==d&&($("#sha").modal("hide"),$("#load").modal("show"));console.log("\u8f38\u51fa\u4e2d");var a=get("output").getContext("2d");a.textAlign="left";a.fillStyle="black";a.font="";var c=new Image;c.onload=function(){lef=parseInt(get("img").style.left.slice(0,get("img").style.left.length-2));to=parseInt(get("img").style.top.slice(0,get("img").style.top.length-2));a.drawImage(c,-201,-1,887,499);a.drawImage(get("img"),lef,to,get("img").width,get("img").height);
var e=new Image;e.onload=function(){a.drawImage(e,0,0,455,682);a.drawImage(get("type"),10,8,73,73);a.font="bold 20px Arial";a.fillStyle="white";a.fillText(get("name").value,100,37);var c=new Image;c.onload=function(){for(var b=0;b<get("numStar").value;b++)a.drawImage(c,100+17*b,46,15,18);a.font="italic 32px Arial";a.textAlign="right";a.fillStyle="white";a.fillText(get("space").value,430,80);a.font="13px Arial";a.fillText(get("cd").value,355,580),"Max"==get("cdLv").value&&(a.fillStyle="#08D7CE");
a.fillText(get("cdLv").value,423,579);get("oup").src=get("output").toDataURL("image/png");console.log("\u8f38\u51fa\u5b8c\u6210");"d"==d?downloadURL():"u"==d?sendToImgur():"s"==d&&shareToFB()};get("sublimation").checked?(a.drawImage(get("s1"),324,470,20,20),a.drawImage(get("s2"),351,470,20,20),a.drawImage(get("s3"),378,470,20,20),a.drawImage(get("s4"),405,470,20,20)):a.drawImage(get("cover"),300,470,132,23);a.font="15px Arial";a.textAlign="left";a.fillStyle="#E7E7E7";a.fillText(get("actName").value,
90,493);a.fillText(get("leaName").value,90,585);a.font="13px Arial";for(var b=0;b<m(get("actBody").value.toString().split("\n").length,3);b++)a.fillText(get("actBody").value.toString().split("\n")[b],31,519+16*b);for(b=0;b<m(get("leaBody").value.toString().split("\n").length,3);b++)a.fillText(get("leaBody").value.toString().split("\n")[b],33,611+16*b);a.drawImage(get("imgRace"),240,444,20,20);a.font="bold 19px Arial";a.textAlign="right";a.fillStyle="white";a.fillText(get("race").value,426,461);a.font=
"21px";a.fillText(get("atk").value,426,429);a.fillText(get("health").value,223,429);a.fillText(get("back").value,223,461);a.font="italic 32px arial";a.fillText(get("nowLv").value,97,397);get("nowLv").value==get("maxLv").value?(a.fillStyle="#08D7CE",a.font="bold italic 15px arial",a.fillText("Max.",128,397)):(a.font="italic 15px arial",a.fillText("/",103,397),a.font="bold italic 15px arial",a.fillText(get("maxLv").value,123,397));get("oup").src=get("output").toDataURL("image/png");c.src="./resource/star.png"};
e.src="./resource/en.png"};c.src="./resource/card_background.jpg"};
	</script>
	<link type="text/css" rel="stylesheet" href="style.css">
	<title>Tower of Savior's card maker</title>
</head>
<body onload="disableSelection(this)">
	<input accept="image/*" onchange="readFile(this)" id="file" style="display:none;" type="file"/>
	<div id="main">
		<img id="img" src="./resource/n.png" style="z-index:101;position:absolute;left:28px;top:73px;" height="327" width="405"/>
		<div id="bord" style="background-image:url(./resource/en.png);">
			<span id="change" onclick="changeType()">
				<img id="type" src="./resource/0.png" />
			</span>
			<div id="header">
				<input id="name" maxlength="15" type="text" placeholder="Card's name"/>
				<div id="star">
					<span class="star"></span>
					<input style="width:60px;left:190px;" onchange="changeStar(this)" id="numStar" min="1" max="12" type="number" placeholder="star"/>
				</div>
			</div>
			<input onchange="if(this.value!='') this.value = Math.round(this.value);if(isNaN(this.value)) this.value=''" maxlength="3" placeholder="Cost" id="space" type="text"/>
			<label id="imgLabel" for="file">
				<div onmousedown="moveStart(this,event)" id="movableIMG" style="display:none;top: -13px; left: 5px;"></div>
				<div class="control_box" onmousedown="changeSizeStart(this,event)" style="display:none;" id="IMGleft"></div>
				<div class="control_box" onmousedown="changeSizeStart(this,event)" style="display:none;" id="IMGright"></div>
				<div class="control_box" onmousedown="changeSizeStart(this,event)" style="display:none;" id="IMGtop"></div>
				<div class="control_box" onmousedown="changeSizeStart(this,event)" style="display:none;" id="IMGbuttom"></div>
				<div class="control_box" onmousedown="changeSizeStart(this,event)" style="display:none;" id="IMGlt"></div>
				<div class="control_box" onmousedown="changeSizeStart(this,event)" style="display:none;" id="IMGrt"></div>
				<div class="control_box" onmousedown="changeSizeStart(this,event)" style="display:none;" id="IMGlb"></div>
				<div class="control_box" onmousedown="changeSizeStart(this,event)" style="display:none;" id="IMGrb"></div>
				<label id="imgChoose" style="display: none; cursor: pointer; position: absolute; left: 350px;" for="file">
					<img height="50" src="./resource/caMERA1.png" onmouseout='this.src="./resource/caMERA1.png"' onmouseover="this.src='./resource/caMERA2.png'" width="50"></img>
				</label>
				<div id="pla" style="font-size:30px;color:white;text-align:center;line-height:280px">
					Have an Image here.
				</div>
			</label>
			<div class="level" style="position:relative;top: 10px;left:60px;">
				<input placeholder="1" maxlength="2" type="text" id="nowLv"/>
				<span style="font-size:15px;color:white;">/</span>
				<input placeholder="99" style="width:16px;height: 16px;font-size: 15px;" maxlength="2" type="text" id="maxLv"/>
			</div>
			<div style="position:relative;left:125px;top:15px;">
				<input maxlength="9" placeholder="0" style="font-weight:bold;font-size:19px;height:25px;width:100px;" type="text" id="health"/>
				<input maxlength="9" placeholder="0" style="font-weight:bold;font-size:19px;position:relative;left:90px;height:25px;width:100px;" type="text" id="atk"/>
				<br/>
				<input maxlength="9" placeholder="0" style="position:relative;top:3px;font-weight:bold;font-size:19px;height:25px;width:100px;" type="text" id="back"/>
				<img id="imgRace" style="position:relative;left:10px;" height="20" width="20" src="./resource/race_8.png" />
				<input onchange="raceChange(this)" placeholder="Race" maxlength="10" style="text-align:right;top:2px;position:relative;left:40px;font-weight:bold;font-size:16px;height:25px;width:130px;" type="text" id="race"/>
			</div>
			<br/>
			<input height="15" maxlength="23" placeholder="Active Skill Name:" id="actName" style="position:relative;left:90px;width:150px;font-size:15px;color:#E7E7E7;" type="text"/>
			<div style="display:inline;position:relative;top:-3px;left:45px;">
				<input onchange="changeOpen(this)" type="checkbox" id="sublimation"/>
				<label style="color:white;z-index: 100;position: relative;" for="sublimation">Amelioration</label>
			</div>
			<div style="top:-4px;display:inline;position:relative;left:62px;height:23px;width:132px;" id="optionSublimation">
				<img id="cover" style="position:relative;left:-25px;z-index: 10;" height="23" width="132" src="./resource/b.png"/>
			</div>
			<textarea style="background-color: transparent;
			font-size:13px;
			position:relative;
			top:5px;
			left:30px;
			border: none;
			outline: none;
			resize : none;
			overflow-y : auto;
			overflow:hidden;
			height:50px; 
			width:390px;
			color:#E7E7E7;" id="actBody" onchange="this.value = addN(this.value)" maxlength="165" placeholder="Please Enter Active Skill:."></textarea>
			<div id="leaderSkill" style="position:relative;top:13px;">
				<input height="15" maxlength="23" placeholder="Leder Skill name" id="leaName" style="position:relative;left:90px;width:180px;font-size:15px;color:#E7E7E7;" type="text"/>
				<div style="display:inline;position:relative;top:-3px;left:100px;"></div>
				<div style="display:inline;position:relative;left:160px;top:3px;">
					<input type="number" maxlength="2" placeholder="1" onchange="if(this.value>99)this.value=99;if(this.value<0)this.value=0;if(this.value!='') this.value = Math.round(this.value);if(isNaN(this.value)) this.value=''" id="cd" style="width: 30px;
 						position: relative;
 						top: -6px;" max="99" min="0">
					<input type="text" placeholder="1" maxlength="3" id="cdLv" style="width: 30px;
 						position: relative;
 						top: -6px;
 						left: 25px;">
				</div>
				<textarea style="background-color: transparent;
				font-size:13px;
				position:relative;
				top:8px;
				left:30px;
				border: none;
				outline: none;
				color:white;
				resize : none;
				overflow-y : auto;
				overflow:hidden;
				height:50px; 
				width:390px;
				color:#E7E7E7;" id="leaBody" onchange="this.value = addN(this.value)" maxlength="165" placeholder="Please Enter Leader Skill."></textarea>
			</div>
		</div>
	</div>
	<button onclick='draw("a");' style="height:40px;width:111px;cursor:default;">Image preview</button>
	<button onclick="draw('d');" style="height:40px;width:111px;cursor:default;">Download it!</button>
	<a style="display:none;" id="a" href="" download="">aaaaaaa</a>
	<canvas style="z-index:1;position:absolute;top:0px;left:455px;" height="682" width="455" id="output"></canvas>
	<img style="z-index:2;position:absolute;top:0px;left:455px;" height="682" width="455" id="oup" src="./resource/n.png"/>
	<button onclick='draw("u");' style="height:40px;width:111px;cursor:default;">Upload</button> 
	<button onclick="$('#sha').modal('show')"  style="cursor:default;height:40px;width:111px;">Share To FB</button>
	<div class="fb-like" data-href="https://www.facebook.com/ToS.Card.Maker" data-layout="standard" data-action="like" data-show-faces="false" data-share="false"></div>
	<br/>
	Other people also madeï¼š
	<iframe frameborder="0" width="100%" height="400" src="http://card.boxhost.me/frame.php"></iframe>
	<div id="fb-root"></div>
	<div class="modal fade bs-example-modal-lg" id="sha" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
  		<div class="modal-dialog modal-lg">
    		<div class="modal-content">
      			<div style="background-color:black;color:white;" class="modal-header">
      				<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
      				<div class="modal-title">Enter What you want to publish</div>
      			</div>
      			<div class="modal-body">
      				<textarea style="margin: 0px;
						height: 78px;
						width: 100%;
						resize : none;" 
					id="pd" placeholder="Enter What you want to publish"></textarea>
      			</div>
      			<div class="modal-footer">
			        <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
			        <button onclick="draw('s')" type="button" class="btn btn-primary">Share</button>
			    </div>
    		</div>
  		</div>
	</div>
	<div class="modal fade bs-example-modal-lg" id="load" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
  		<div class="modal-dialog modal-lg">
    		<div class="modal-content">
      			<div style="background-color:black;color:white;" class="modal-header">
      				<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
      				<div class="modal-title">Uploading</div>
      			</div>
      			<div class="modal-body">
      				Uploading........
      			</div>
      			<div class="modal-footer">
			        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
			    </div>
    		</div>
  		</div>
	</div>
	<div class="modal fade bs-example-modal-lg" id="sdone" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
  		<div class="modal-dialog modal-lg">
    		<div class="modal-content">
      			<div style="background-color:black;color:white;" class="modal-header">
      				<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
      				<div class="modal-title">Share succeed</div>
      			</div>
      			<div class="modal-body">
      				Youe Post:<a id="url" href></a>
      			</div>
      			<div class="modal-footer">
			        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
			    </div>
    		</div>
  		</div>
	</div>
	<div class="modal fade bs-example-modal-lg" id="udone" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
  		<div class="modal-dialog modal-lg">
    		<div class="modal-content">
      			<div style="background-color:black;color:white;" class="modal-header">
      				<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
      				<div class="modal-title">Upload succeed</div>
      			</div>
      			<div class="modal-body">
      				Image link:<a id="link" href></a>
      			</div>
      			<div class="modal-footer">
			        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
			    </div>
    		</div>
  		</div>
	</div>
</body>
</html>
